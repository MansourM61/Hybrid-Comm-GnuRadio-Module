id: Hybrid_Comm_Remove_Header
label: Remove Header
category: '[Hybrid Communication]'

templates:
  imports: import Hybrid_Comm
  make: Hybrid_Comm.Remove_Header(${packetSize}, ${preamble}, ${label}, ${samplesPerBit})
  callbacks:
  - set_Preamble(${preamble})
  - set_Label(${label})
  - set_SamplesPerBit(${samplesPerBit})
  - set_PacketSize(${packetSize})


#  Make one 'parameters' list entry for every parameter you want settable from the GUI.
#     Keys include:
#     * id (makes the value accessible as \$keyname, e.g. in the make entry)
#     * label (label shown in the GUI)
#     * dtype (e.g. int, float, complex, byte, short, xxx_vector, ...)
parameters:
- id: preamble
  label: Preamble
  dtype: raw
  default: (0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0)
- id: label
  label: Packet label
  dtype: string
  default: L1
- id: samplesPerBit
  label: Samples per bit
  dtype: int
  default: 1
- id: packetSize
  label: Output packet samples size
  dtype: int
  default: 1000


asserts:
  - ${ len(preamble) >= 1 }
  - ${ samplesPerBit >= 1 }
  - ${ packetSampLen >= 1 }


#  Make one 'inputs' list entry per input and one 'outputs' list entry per output.
#  Keys include:
#      * label (an identifier for the GUI)
#      * domain (optional - stream or message. Default is stream)
#      * dtype (e.g. int, float, complex, byte, short, xxx_vector, ...)
#      * vlen (optional - data stream vector length. Default is 1)
#      * optional (optional - set to 1 for optional inputs. Default is 0)
inputs:
- label: pack
  dtype: byte
- label: spb
  dtype: byte
  optional: 1

outputs:
- label: str
  dtype: byte
- label: sync
  dtype: byte
- label: count
  dtype: int
- label: spb
  dtype: byte
  optional: 1


documentation: |-
  The blocks removes the header from the incoming data array. It recognises the preamble as well as the label and the counter of the header.
  After removing the header the data is sent to th output while the read counter is also made available at the 'Counter' pin. A synchronisation
  pulse at 'sync' pin is used to show the beginning of the data section.
  if 'Counter' pin value is -1, then the output data is not valid.
  The pattern will be like:  [Preamble, Label, Counter, Data]
  Counter field has 8 bits length.


#  'file_format' specifies the version of the GRC yml format used in the file
#  and should usually not be changed.
file_format: 1
